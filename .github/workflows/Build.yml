name: Build packages

on:
  push:
  workflow_call:
    secrets:
      ANACONDA_TOKEN:
        description: 'Anaconda Token'
      ANACONDA_USER:
        description: 'Anaconda User'

env:
  ANACONDA_TOKEN: ${{ secrets.ANACONDA_TOKEN }}
  ANACONDA_USER: ${{ secrets.ANACONDA_USER }}

defaults:
  run:
    shell: bash

jobs:
  #1
  magic-linux:
    runs-on: "ubuntu-20.04"
    env:
      PACKAGE: "misc/magic"
      OS_NAME: "linux"
    steps:
      - uses: actions/checkout@v3
      - name: 'Install csh'
        run: |
          sudo apt update
          sudo apt install -y csh
      - uses: ./ci

  #68
  xyce-linux:
    runs-on: "ubuntu-20.04"
    env:
      CONDA_BUILD_PREPARE_REV: "aj-fix-describe"
      PACKAGE: "sim/xyce"
      OS_NAME: "linux"
    steps:
      - uses: actions/checkout@v3
      - uses: ./ci
